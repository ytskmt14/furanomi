# Requirements Document

## Introduction

新規店舗登録から利用者アプリへの公開までのフローを整理し、UI/UXを改善することで、システム管理者と店舗管理者がスムーズに店舗を登録・公開できるようにします。ステップバイステップのガイド、公開前の確認機能、明確な進捗表示により、登録プロセスの透明性と使いやすさを向上させます。

## Requirements

### Requirement 1: ステップバイステップの登録フロー
**Objective:** As a システム管理者, I want 明確なステップに分かれた店舗登録フローを利用できる, so that 登録プロセスを理解しやすく、必要な情報を漏れなく入力できる

#### Acceptance Criteria
1. WHEN システム管理者が新規店舗登録を開始する場合 THEN システム SHALL 複数のステップに分割された登録フォームを表示する
2. WHEN システム管理者が各ステップを完了する場合 THEN システム SHALL 次のステップへの進捗を視覚的に表示する
3. WHEN システム管理者が前のステップに戻る場合 THEN システム SHALL 入力済みの情報を保持したまま前のステップを表示する
4. WHEN システム管理者が各ステップで必須項目を未入力のまま次へ進もうとする場合 THEN システム SHALL エラーメッセージを表示し、該当ステップでの入力を促す
5. WHEN システム管理者が登録フローを完了する場合 THEN システム SHALL 登録完了画面を表示し、次のアクション（公開前確認など）を案内する

### Requirement 2: 店舗基本情報入力の改善
**Objective:** As a システム管理者, I want 店舗の基本情報を効率的に入力できる, so that 正確な情報を素早く登録できる

#### Acceptance Criteria
1. WHEN システム管理者が店舗名を入力する場合 THEN システム SHALL 最大文字数制限（200文字）を表示し、超過時にエラーを表示する
2. WHEN システム管理者が店舗説明を入力する場合 THEN システム SHALL 文字数カウンターを表示し、入力可能な最大文字数を示す
3. WHEN システム管理者がカテゴリを選択する場合 THEN システム SHALL 利用可能なカテゴリ（レストラン、カフェ、居酒屋）を明確に表示する
4. WHEN システム管理者が住所を入力する場合 THEN システム SHALL 郵便番号から住所を自動補完する機能を提供する
5. WHEN システム管理者が位置情報を取得する場合 THEN システム SHALL 「位置取得」ボタンを明確に表示し、クリック時に地図上で位置を確認できるようにする
6. WHEN システム管理者が位置情報を取得する場合 THEN システム SHALL 緯度経度が取得できていない場合、次のステップへの進行を阻止する
7. WHEN システム管理者が連絡先情報を入力する場合 THEN システム SHALL 電話番号とメールアドレスの形式をバリデーションする

### Requirement 3: 店舗管理者の割り当て
**Objective:** As a システム管理者, I want 店舗管理者を既存から選択または新規作成できる, so that 適切な管理者を店舗に割り当てられる

#### Acceptance Criteria
1. WHEN システム管理者が店舗管理者を割り当てる場合 THEN システム SHALL 既存の店舗管理者一覧から選択するオプションを提供する
2. WHEN システム管理者が店舗管理者を割り当てる場合 THEN システム SHALL 新規店舗管理者を作成するオプションを提供する
3. WHEN システム管理者が新規店舗管理者を作成する場合 THEN システム SHALL ユーザー名、メールアドレス、パスワード、氏名、電話番号の入力フォームを表示する
4. WHEN システム管理者が新規店舗管理者を作成する場合 THEN システム SHALL 必須項目（ユーザー名、メールアドレス、パスワード、氏名）が未入力の場合、エラーを表示する
5. WHEN システム管理者が店舗管理者を割り当てずに次へ進もうとする場合 THEN システム SHALL 店舗管理者の割り当てが必要であることを示すエラーメッセージを表示する

### Requirement 4: 営業時間設定の改善
**Objective:** As a システム管理者, I want 営業時間を直感的に設定できる, so that 正確な営業時間情報を登録できる

#### Acceptance Criteria
1. WHEN システム管理者が営業時間を設定する場合 THEN システム SHALL 各曜日ごとに営業開始時刻と終了時刻を設定できるフォームを表示する
2. WHEN システム管理者が営業時間を設定する場合 THEN システム SHALL 終了時刻が翌日にまたがる場合は「翌日」フラグを設定できるオプションを提供する
3. WHEN システム管理者が営業時間を設定する場合 THEN システム SHALL 休業日の設定オプションを提供する
4. WHEN システム管理者が営業時間の形式が不正な場合 THEN システム SHALL エラーメッセージを表示し、正しい形式での入力を促す
5. WHEN システム管理者が営業時間を未設定のまま次へ進む場合 THEN システム SHALL デフォルトの営業時間（9:00-21:00）を適用するか、未設定のまま進めることを許可する

### Requirement 5: 店舗画像アップロードの改善
**Objective:** As a システム管理者, I want 店舗画像を簡単にアップロードできる, so that 視覚的に魅力的な店舗情報を提供できる

#### Acceptance Criteria
1. WHEN システム管理者が店舗画像をアップロードする場合 THEN システム SHALL ドラッグ&ドロップまたはファイル選択ダイアログで画像を選択できるようにする
2. WHEN システム管理者が店舗画像をアップロードする場合 THEN システム SHALL アップロード前に画像プレビューを表示する
3. WHEN システム管理者が店舗画像をアップロードする場合 THEN システム SHALL サポートされる画像形式（JPEG、PNG）と最大ファイルサイズを表示する
4. WHEN システム管理者がサポートされていない形式またはサイズ超過の画像をアップロードしようとする場合 THEN システム SHALL エラーメッセージを表示し、アップロードを拒否する
5. WHEN システム管理者が店舗画像をアップロードする場合 THEN システム SHALL クライアントサイドで画像を自動的に圧縮する（最大800x600ピクセル、JPEG品質80%）

### Requirement 6: 公開前確認・プレビュー機能
**Objective:** As a システム管理者, I want 公開前に店舗情報を確認できる, so that 正確な情報が利用者アプリに表示されることを確認できる

#### Acceptance Criteria
1. WHEN システム管理者が店舗登録を完了する場合 THEN システム SHALL 公開前確認画面を表示する
2. WHEN システム管理者が公開前確認画面を表示する場合 THEN システム SHALL 入力したすべての店舗情報を一覧表示する
3. WHEN システム管理者が公開前確認画面を表示する場合 THEN システム SHALL 利用者アプリでの表示プレビューを提供する
4. WHEN システム管理者が公開前確認画面で情報を修正する場合 THEN システム SHALL 該当するステップに戻り、修正を可能にする
5. WHEN システム管理者が公開前確認画面で「公開する」を選択する場合 THEN システム SHALL 店舗をアクティブ状態（is_active = true）に設定する
6. WHEN システム管理者が公開前確認画面で「後で公開する」を選択する場合 THEN システム SHALL 店舗を非アクティブ状態（is_active = false）のまま保存する

### Requirement 7: 必須項目の明確化とバリデーション
**Objective:** As a システム管理者, I want 必須項目が明確に表示される, so that 必要な情報を漏れなく入力できる

#### Acceptance Criteria
1. WHEN システム管理者が登録フォームを表示する場合 THEN システム SHALL 必須項目に「*」マークまたは視覚的なインジケーターを表示する
2. WHEN システム管理者が必須項目を未入力のまま保存しようとする場合 THEN システム SHALL 該当する項目にエラーメッセージを表示する
3. WHEN システム管理者が必須項目を未入力のまま保存しようとする場合 THEN システム SHALL エラーが発生した項目まで自動的にスクロールする
4. WHEN システム管理者が入力形式が不正な場合 THEN システム SHALL 具体的なエラーメッセージと正しい入力例を表示する
5. WHEN システム管理者がすべての必須項目を入力する場合 THEN システム SHALL 次のステップへの進行を許可する

### Requirement 8: 登録進捗の視覚的表示
**Objective:** As a システム管理者, I want 登録の進捗状況を視覚的に確認できる, so that 現在の位置と残りのステップを把握できる

#### Acceptance Criteria
1. WHEN システム管理者が登録フローを開始する場合 THEN システム SHALL ステップインジケーター（例：ステップ1/5）を表示する
2. WHEN システム管理者が各ステップを完了する場合 THEN システム SHALL 完了したステップを視覚的にマークする（チェックマークなど）
3. WHEN システム管理者が登録フローを表示する場合 THEN システム SHALL 現在のステップを強調表示する
4. WHEN システム管理者が登録フローを表示する場合 THEN システム SHALL 未完了のステップをグレーアウトまたは非アクティブ表示する
5. WHEN システム管理者が登録フローを表示する場合 THEN システム SHALL 完了したステップへの戻りを許可する

### Requirement 9: 公開後の確認と通知
**Objective:** As a システム管理者, I want 店舗公開後に確認できる, so that 公開が正常に完了したことを確認できる

#### Acceptance Criteria
1. WHEN システム管理者が店舗を公開する場合 THEN システム SHALL 公開成功メッセージを表示する
2. WHEN システム管理者が店舗を公開する場合 THEN システム SHALL 利用者アプリでの店舗表示へのリンクを提供する
3. WHEN システム管理者が店舗を公開する場合 THEN システム SHALL 店舗管理者への通知オプションを提供する（将来実装）
4. WHEN システム管理者が公開後の店舗情報を確認する場合 THEN システム SHALL 店舗管理画面から利用者アプリでの表示を確認できるリンクを提供する

### Requirement 10: エラーハンドリングとガイダンス
**Objective:** As a システム管理者, I want 明確なエラーメッセージとガイダンスを受けられる, so that 問題を迅速に解決できる

#### Acceptance Criteria
1. WHEN システム管理者が登録中にエラーが発生する場合 THEN システム SHALL 具体的で理解しやすいエラーメッセージを表示する
2. WHEN システム管理者がネットワークエラーで保存に失敗する場合 THEN システム SHALL エラーメッセージを表示し、再試行オプションを提供する
3. WHEN システム管理者が登録中にエラーが発生する場合 THEN システム SHALL 入力済みの情報を保持し、エラー修正後に再送信できるようにする
4. WHEN システム管理者が各入力フィールドにフォーカスする場合 THEN システム SHALL 該当フィールドの入力ガイド（例：ツールチップ、プレースホルダー）を表示する
5. WHEN システム管理者が不明な点がある場合 THEN システム SHALL ヘルプリンクまたはサポート情報へのアクセスを提供する

### Requirement 11: 店舗管理者による公開前情報の確認と編集
**Objective:** As a 店舗管理者, I want 公開前の店舗情報を確認・編集できる, so that 自分の店舗の情報が正確であることを確認し、必要に応じて修正できる

#### Acceptance Criteria
1. WHEN 店舗管理者がログインする場合 THEN システム SHALL 紐づけられた店舗が公開前（is_active = false）の場合、公開前であることを明確に表示する
2. WHEN 店舗管理者が公開前の店舗情報を確認する場合 THEN システム SHALL 店舗情報編集画面で現在の店舗情報を表示する
3. WHEN 店舗管理者が公開前の店舗情報を確認する場合 THEN システム SHALL 「公開前」または「未公開」のステータスバッジを表示する
4. WHEN 店舗管理者が公開前の店舗情報を編集する場合 THEN システム SHALL 店舗名、説明、住所、電話番号、メールアドレス、カテゴリ、営業時間、画像を編集できるようにする
5. WHEN 店舗管理者が公開前の店舗情報を編集する場合 THEN システム SHALL 位置情報（緯度経度）の編集を許可する（システム管理者による位置取得と同様の機能）
6. WHEN 店舗管理者が公開前の店舗情報を保存する場合 THEN システム SHALL 変更内容をデータベースに反映する
7. WHEN 店舗管理者が公開前の店舗情報を保存する場合 THEN システム SHALL 店舗の公開状態（is_active）は変更できないようにする（店舗管理者は公開/非公開の切り替えができない）
8. WHEN 店舗管理者が公開前の店舗情報を編集する場合 THEN システム SHALL 必須項目のバリデーションを実行する（店舗名、住所、位置情報など）
9. WHEN 店舗管理者が公開前の店舗情報を確認する場合 THEN システム SHALL 利用者アプリでの表示プレビューを提供する（公開前でもプレビュー可能）
10. WHEN 店舗管理者が公開前の店舗情報を編集した場合 THEN システム SHALL 編集完了時に「店舗情報を更新しました」などの成功メッセージを表示する
11. WHEN 店舗管理者が公開前の店舗情報を確認する場合 THEN システム SHALL 「公開準備が完了したらシステム管理者に連絡してください」などの案内メッセージを表示する
