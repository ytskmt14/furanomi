# user-app Specification

## Purpose
TBD - created by archiving change add-furanomi-system. Update Purpose after archive.
## Requirements
### Requirement: 店舗検索・一覧表示
利用者は現在地から近い店舗の空き状況を確認できる。システムSHALL位置情報に基づいて店舗を検索し、空き状況と距離を表示する。

#### Scenario: 位置情報取得
- **WHEN** 利用者がアプリにアクセスする
- **THEN** ブラウザの位置情報APIを使用して現在地を取得する
- **AND** 取得した位置情報を「現在地: 福岡県福岡市東区香椎」として表示する

#### Scenario: 店舗検索
- **WHEN** 利用者の位置情報が取得される
- **THEN** 設定された検索半径内の店舗を検索する
- **AND** 営業時間外の店舗は自動的に「営業時間外」として判定される

#### Scenario: 店舗一覧表示
- **WHEN** 店舗検索が完了する
- **THEN** 店舗カードが一覧で表示される
- **AND** 営業中の店舗が上位、営業時間外の店舗が下位に表示される
- **AND** 営業中の店舗は距離順でソートされる

### Requirement: 店舗カード表示（最適化版）
利用者は店舗の基本情報をカード形式で確認できる。システムSHALL重要な情報を優先的に表示する。

#### Scenario: 店舗カードレイアウト
- **WHEN** 利用者が店舗一覧を表示する
- **THEN** 各店舗カードに以下の情報が表示される：
  - 店舗画像
  - 左上：空き状況バッジ（🟢空きあり、🟡混雑、🔴満席、⚫営業時間外）
  - 右上：距離表示（📍 134m）
  - 店舗名
  - ハッシュタグ形式のカテゴリ（#居酒屋、#カフェ、#レストラン）

#### Scenario: 営業時間外の表示
- **WHEN** 店舗が営業時間外の場合
- **THEN** 店舗画像上に「営業時間外」オーバーレイが表示される
- **AND** カードのクリックが無効化される

#### Scenario: 情報の簡素化
- **WHEN** 利用者が店舗一覧を表示する
- **THEN** 住所は表示されない（店舗詳細でのみ表示）
- **AND** カテゴリアイコンは表示されない（ハッシュタグで代替）

### Requirement: 店舗詳細表示
利用者は店舗の詳細情報を確認できる。システムSHALL営業時間を含む詳細情報をモーダルで表示する。

#### Scenario: 店舗詳細モーダル
- **WHEN** 利用者が営業中の店舗カードをクリックする
- **THEN** 店舗詳細モーダルが表示される
- **AND** 以下の情報が表示される：
  - 店舗名と空き状況バッジ
  - 店舗説明
  - カテゴリ
  - 住所
  - 電話番号（設定されている場合）
  - メールアドレス（設定されている場合）
  - **全曜日の営業時間**

#### Scenario: 営業時間表示（全曜日）
- **WHEN** 利用者が店舗詳細を表示する
- **THEN** 以下の形式で営業時間が表示される：
  ```
  日曜日: 17:00 - 22:00
  月曜日: 17:00 - 04:00 (翌日)
  火曜日: 17:00 - 23:00
  水曜日: 17:00 - 23:00
  木曜日: 17:00 - 23:00
  金曜日: 17:00 - 24:00
  土曜日: 17:00 - 24:00
  ```
- **AND** 営業時間が設定されていない曜日は「定休日」と表示される

#### Scenario: 距離情報の非表示
- **WHEN** 利用者が店舗詳細を表示する
- **THEN** 現在地からの距離は表示されない（店舗一覧でのみ表示）

### Requirement: 営業時間自動判定
システムは営業時間に基づいて店舗の営業状況を自動判定する。システムSHALL現在時刻と営業時間を比較して営業状況を決定する。

#### Scenario: 同日営業の判定
- **WHEN** 店舗の営業時間が同日営業（例：08:00-20:00）の場合
- **THEN** 現在時刻が営業時間内であれば営業中、外であれば営業時間外と判定する

#### Scenario: 日付跨ぎ営業の判定
- **WHEN** 店舗の営業時間が日付跨ぎ（例：17:00-04:00 翌日）の場合
- **THEN** 現在時刻が営業開始時刻以降または営業終了時刻（翌日）未満であれば営業中と判定する
- **AND** 例：月曜日17:00-火曜日04:00の場合、火曜日02:00は営業中と判定される

#### Scenario: 前日営業時間の考慮
- **WHEN** 現在時刻が今日の営業時間外の場合
- **THEN** 前日の営業時間が日付跨ぎで翌日まで営業している場合、その営業時間内かどうかを判定する

### Requirement: レスポンシブデザイン
利用者はモバイルデバイスでも快適に利用できる。システムSHALLモバイル・タブレットに最適化されたUIを提供する。

#### Scenario: モバイル表示
- **WHEN** 利用者がスマートフォンでアプリにアクセスする
- **THEN** モバイルに最適化されたUIで操作できる
- **AND** 店舗カードは1列表示で見やすく配置される

#### Scenario: タブレット表示
- **WHEN** 利用者がタブレットでアプリにアクセスする
- **THEN** タブレットに最適化されたUIで操作できる
- **AND** 店舗カードは2列表示で効率的に配置される

### Requirement: 表示切り替え
利用者はリスト表示と地図表示を切り替えられる。システムSHALL現在はリスト表示のみを提供する。

#### Scenario: 表示モード切り替え
- **WHEN** 利用者が表示モードを切り替える
- **THEN** 「リスト表示」と「地図表示」のボタンが表示される
- **AND** 現在は「リスト表示」のみが有効で、「地図表示」は将来実装予定

### Requirement: 検索・フィルタ機能
利用者は店舗を検索・フィルタできる。システムSHALL基本的な検索機能を提供する。

#### Scenario: 店舗検索
- **WHEN** 利用者が検索ボタンをクリックする
- **THEN** 検索モーダルが表示される
- **AND** 店舗名、カテゴリ、空き状況でフィルタできる

#### Scenario: 空き状況フィルタ
- **WHEN** 利用者が空き状況でフィルタする
- **THEN** 「空きあり」「混雑」「満席」「営業時間外」で絞り込める

### Requirement: 地図表示機能
利用者は店舗の位置を地図上で確認できる。システムSHALL Google Maps APIを使用して地図表示機能を提供する。

#### Scenario: 地図表示の初期化
- **WHEN** 利用者が地図表示に切り替える
- **THEN** Google Maps APIが初期化され、現在地を中心とした地図が表示される
- **AND** 地図のズームレベルは適切に設定される

#### Scenario: 店舗マーカーの表示
- **WHEN** 地図が表示される
- **THEN** 検索結果の店舗がマーカーとして表示される
- **AND** 各マーカーは空き状況に応じて色分けされる
- **AND** マーカーには店舗名が表示される

#### Scenario: マーカーの色分け
- **WHEN** 店舗マーカーが表示される
- **THEN** 空き状況に応じて以下の色で表示される：
  - 空きあり: 緑色
  - 混雑: 黄色
  - 満席: 赤色
  - 営業時間外: グレー

#### Scenario: マーカークリック
- **WHEN** 利用者が店舗マーカーをクリックする
- **THEN** 店舗詳細モーダルが表示される
- **AND** リスト表示と同じ店舗詳細情報が表示される

### Requirement: 表示切り替え機能
利用者はリスト表示と地図表示を切り替えられる。システムSHALL 簡単な切り替えボタンを提供する。

#### Scenario: 表示モード切り替え
- **WHEN** 利用者が表示切り替えボタンをクリックする
- **THEN** リスト表示と地図表示が切り替わる
- **AND** 現在の表示モードが視覚的に分かる

#### Scenario: データの同期
- **WHEN** 表示モードが切り替わる
- **THEN** 同じ店舗データが両方の表示で使用される
- **AND** 検索結果やフィルタが両方に反映される

### Requirement: レスポンシブ地図表示
地図表示はモバイルデバイスでも快適に利用できる。システムSHALL モバイルファーストの地図表示を提供する。

#### Scenario: モバイル地図表示
- **WHEN** 利用者がスマートフォンで地図表示にアクセスする
- **THEN** モバイルに最適化された地図サイズで表示される
- **AND** タッチ操作で地図の移動・ズームが可能

#### Scenario: タブレット地図表示
- **WHEN** 利用者がタブレットで地図表示にアクセスする
- **THEN** タブレットに最適化された地図サイズで表示される
- **AND** より大きな画面を活用した表示

